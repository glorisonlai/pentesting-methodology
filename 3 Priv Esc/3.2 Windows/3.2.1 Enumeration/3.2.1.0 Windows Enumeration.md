# Windows Enumeration
## Common
- ### Downloading files
		certutil -urlcache -f <URL> <OUTPUT_FILE>

- ### System Info
		systeminfo
		
		systeminfo | findstr /B /C:"<LABEL>"
	#### Useful Labels:
	- OS Name
	- OS Version
	- System Type
- ### Hot patches
		wmic qfe
- ### Drives
		wmic logicaldisk get caption, description, providername
- ### User/Service Info
		whoami
		
		whoami /priv
		
		whoami /groups
- ### View users
		net user
		
		net user <USER>
- ### View groups
		net localgroup
		
		net localgroup <GROUP>
	#### Default Groups:
	- administrators

## Quick Wins
- ### Password finding
		findstr /si PASSWORD *.txt *.ini *.config *.xml
- ### Stored credentials
		cmdkey /list
- ### Full Access to Startup Services
		icacls "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup" # Looking for :(F)
	
## RDP Enumeration
- ### Recycle bin
- ### Internet history

## Network Enumeration
- ### Local Network Discovery
		ipconfig /all
		
		arp -a
		
		route print
- ### Wifi Credentials
		netsh wlan show profile # -> SSID
		
		netsh wlan show profile <SSID> key=clear
- ### Open ports
		netstat -ano
- ### Firewall Configuration
		netsh advfirewall firewall dump
		
		netsh firewall show config
		
		firewall show state
		
## Antivirus Enumeration
	sc queryex type=service
	
	sc query <AV>
#### Default AV
- windefend

## Scripts
	winPeas
	Seatbelt
	Watson
	SharpUp
	windows-exploit-suggester
	Sherlock
	PowerUp # Invoke-AllChecks
	Powersploit
	jaws-enum
	Metasploit Exploit Suggester
	accesschk64
		
		
#### Links
Stored Credentials: [[3.2.2.0 Common Exploits#Stored Credentials]]
SeImpersonatePrivilege/SeAssignPrimaryToken enabled: [[3.2.2.0 Common Exploits#Potato Exploits]]
SeDebugPrivilege enabled: [[3.2.2.0 Common Exploits]]
Writable StartUp Program: [[3.2.2.3 Program Exploits#Startup Programs]]
RDP Exploits: [[3.2.2.6 RDP Exploits]]